install.packages("svDialogs")
library(rvent)
library(rvent)
devtools::install_github("c1au6i0/rvent")
devtools::install_github("c1au6i0/rvent")
devtools::install_github("c1au6i0/rvent")
devtools::install_github("c1au6i0/rvent")
devtools::install_github("c1au6i0/rvent")
devtools::install_deps(dependencies = TRUE)
remove.packages("svDialogs")
devtools::install_deps(dependencies = TRUE)
devtools::install_github("c1au6i0/rvent")
devtools::install_github("c1au6i0/rvent", force = TRUE)
devtools::install_deps(dependencies = TRUE)
devtools::install_dev_deps(dependencies = TRUE)
devtools::install_github("c1au6i0/rvent")
devtools::install_deps(dependencies = TRUE)
devtools::install_dev_deps(dependencies = TRUE)
devtools::install_github("c1au6i0/rvent")
devtools::install_deps()
devtools::install_deps()
library(rvent)
devtools::install_deps()
library(rvent)
devtools::install_deps()
library(remotes)
devtools::install_deps()
devtools::install_deps(dependencies = TRUE)
detach("package:remotes", unload = TRUE)
library(remotes)
devtools::test_coverage()
devtools
devtools::test_coverage(show_report = interactive())
devtools::install_deps("rvent")
devtools::install_deps(rvent)
devtools::install_deps()
devtools::install_github("c1au6i0/rvent")
library(rvent)
install_deps()
remove.packages("vroom")
install_deps()
devtools::install_git("SciViews/svDialogs")
devtools::install_git("https://github.com/SciViews/svDialogs")
install_deps()
remove.packages("svDialogs")
install_deps()
devtools::install_deps()
devtools::install_github(SciViews/svDialogs)
devtools::install_github("SciViews/svDialogs")
remove.packages("svDialogs")
install_deps()
devtoos::install_deps()
devtools::install_deps()
library(sloop)
s3_dispatch(rvent::import_session())
library(rvent)
devtools::load_all()
load("~/Documents/R_projects/rvent/R/sysdata.rda")
vent(dat_vent)
autoplot(dat_vent)
class(dat_vent)
class(dat_vent) <- c("data.frame", "vent")
autoplot(dat_vent)
prova <- autoplot(dat_vent)
View(dat_vent)
class(dat_vent)
devtools::install_github(SciViews/svDialogs)
devtools::install_github("SciViews/svDialogs")
devtools::load_all(".")
sess1 <- import_sess()
sess1 <- import_session()
class(sess1)
devtools::load_all(".")
summarize_vent(sess1)
summarize_vent(sess1)
devtools::load_all(".")
prova <- summarize_vent(sess1, inter = FALSE)
devtools::load_all(".")
prova <- summarize_vent(sess1, inter = FALSE)
devtools::load_all(".")
class(dat_vent) <- c("data.frame", "vent")
prova <- summarize_vent(sess1, inter = FALSE)
devtools::load_all(".")
prova <- summarize_vent(sess1, inter = FALSE)
class(dat_vent)
col_melt
class(dat_long) <- "data.frame"
class(dat_all) <- "data.frame"
# wide to long
dat_long <- data.table::melt(dat_all, measure.vars = col_melt[1]:col_melt[2],
variable.name = "measure", value.name = "value")
remove.packages("reshape2")
devtools::load_all(".")
prova <- summarize_vent(sess1, inter = FALSE)
devtools::load_all(".")
load("~/Documents/R_projects/rvent/R/sysdata.rda")
prova <- summarize_vent(sess1, inter = FALSE)
devtools::load_all(".")
prova <- summarize_vent(sess1, inter = FALSE)
devtools::load_all(".")
prova <- summarize_vent(sess1, inter = FALSE)
library(rvent)
prova <- summarize_vent(sess1, inter = FALSE)
devtools::load_all(".")
prova <- summarize_vent(sess1, inter = FALSE)
class(dat_all)
# wide to long
dat_long <- data.table::melt(as.data.table(dat_all), measure.vars = col_melt[1]:col_melt[2],
variable.name = "measure", value.name = "value")
# first data summary
dat_vent <- dat_long %>%
dplyr::group_by(.data$cpu_date, .data$subj_drug, .data$dose, .data$unit, .data$int_min, .data$measure) %>%
dplyr::summarise(mean = mean(.data$value),
median = median(.data$value),
sd = sd(.data$value),
n = dplyr::n(),
baseline = baseline,
bin = bin) %>%
tidyr::separate(.data$subj_drug, c("subj", "drug"), remove = TRUE)
class(dat_vent) <- c("data.frame", "vent")
# data summary longer
dat_sm  <- data.table::melt(as.data.table(dat_vent), measure.vars = c("mean", "median", "sd", "n"),
variable.name = "stat", value.name = "value") %>%
dplyr::filter(.data$stat %in% form) %>%
dplyr:: arrange(as.numeric(.data$int_min), .data$stat) %>%
tidyr::unite("int_stat", .data$int_min, .data$stat, sep = "_")
# reorder levels
dat_sm$int_stat <- factor(dat_sm$int_stat, levels = unique(dat_sm$int_stat))
dat_sm <- data.table::dcast(dat_sm,
cpu_date + subj + drug + dose + unit +  measure ~ int_stat, value.var = "value")
dat_sm <- data.table::dcast(as.data.table(dat_sm),
cpu_date + subj + drug + dose + unit +  measure ~ int_stat, value.var = "value")
# data summary longer
dat_sm  <- data.table::melt(as.data.table(dat_vent), measure.vars = c("mean", "median", "sd", "n"),
variable.name = "stat", value.name = "value") %>%
dplyr::filter(.data$stat %in% form) %>%
dplyr:: arrange(as.numeric(.data$int_min), .data$stat) %>%
tidyr::unite("int_stat", .data$int_min, .data$stat, sep = "_")
dat_sm <- data.table::dcast(as.data.table(dat_sm),
cpu_date + subj + drug + dose + unit +  measure ~ int_stat, value.var = "value")
class(dat_vent)
prova <- summarize_vent(sess1, inter = FALSE)
prova <- summarize_vent(sess1, inter = FALSE)
devtools::load_all(".")
prova <- summarize_vent(sess1, inter = FALSE)
class(prova)
class(prova$dat_sm)
devtools::load_all(".")
prova <- summarize_vent(sess1, inter = FALSE)
class(data_sm)
class(dat_sm)
devtools::load_all(".")
class(prova$dat_vent)
dat_vent <- prova$dat_vent
usethis::use_data(comments_tofill, dat_vent, sess1, vent_head, internal = TRUE, overwrite = TRUE)
autoplot(dat_vent)
devtools::load_all(".")
session_plots(sess1)
devtools::load_all(".")
install.packages(c("covr", "htmltools", "htmlwidgets", "KernSmooth", "later", "mgcv", "promises", "rvcheck", "shiny", "strucchange", "tinytex"))
install.packages(c("covr", "htmltools", "htmlwidgets", "KernSmooth", "later", "mgcv", "promises", "rvcheck", "shiny", "strucchange", "tinytex"))
devtools::install_deps()
remove.packages("svDialogs")
devtools::install_deps()
sessionInfo()
sessionInfo()
reprex:::reprex_addin()
reprex:::reprex_addin()
load("~/Documents/R_projects/rvent/R/sysdata.rda")
devtools::load_all(".")
validate_vent(dat_vent)
as.data.frame(sapply(dat, typeof))
expected <- as.data.frame(sapply(dat, typeof))
expected <- as.data.frame(sapply(dat_vent, typeof))
ls()
rland::enquo(ls())
rlang::enquo(ls())
prova <- ls()
rlang::enquo(prova)
eval(rlang::enquo(prova))
eval(ls())
eval(prova)
eval(parse_expr("ls()"))
library(rland)
library(rlang)
eval(parse_expr("ls()"))
eval(parse_expr(ls()))
get(ls())
ls()
get(ls())
expected_vent <- as.data.frame(sapply(dat_vent, typeof))
View(comments_tofill)
usethis::use_data(comments_tofill, dat_vent, expected_vent, sess1, vent_head, internal = TRUE, overwrite = TRUE)
devtools::install_deps()
devtools::install_deps()
devtools::install_github("c1au6i0/rvent")
devtool::install_dev()
devtools::install_dev()
devtools::install_deps()
devtools::install_deps()
remove.packages("svDialogs")
install.packages("svDialogs")
devtools::install_deps()
remove.packages("svDialogs")
devtools::install_deps()
remove.packages("svDialogs")
devtools::install_deps()
load("~/Documents/R_projects/rvent/R/sysdata.rda")
devtools::load_all(".")
load("~/Documents/R_projects/rvent/R/sysdata.rda")
validate_vent(dat_vent)
validate_vent(dat_vent)
obtained <- as.data.frame(sapply(dat, typeof))
if(!all.equal(expect_vent == obtained)) stop("Wrong columns: check number of columns and or/and their types")
devtools::load_all(".")
validate_vent(dat_vent)
devtools::load_all(".")
validate_vent(dat_vent)
devtools::load_all(".")
validate_vent(dat_vent)
View(expected_vent)
devtools::load_all(".")
validate_vent(dat_vent)
View(expected_vent)
obtained <- as.data.frame(sapply(dat_vent, typeof))
View(obtained)
devtools::load_all(".")
obtained <- as.data.frame(sapply(dat_vent, typeof))
remove(obtained)
validate_vent(dat_vent)
list(expected_vent)
as.data.frame(expected_vent)
row.names(expected_vent)
paste(row.names(expected_vent), sep = " ")
warnings(paste(row.names(expected_vent), sep = " "))
warning(paste(row.names(expected_vent), sep = " "))
warning(paste(row.names(expected_vent), sep = "  "))
warning(paste(row.names(expected_vent), collapse = "  "))
warning(paste(row.names(expected_vent), collapse = ", "))
if(row.names(expected_vent) != row.names(obtained)) stop("Expected columns are", paste(row.names(expected_vent), collapse = ", "))
stop("Expected columns are", paste(row.names(expected_vent), collapse = ", "))
stop("Expected columns are: ", paste(row.names(expected_vent), collapse = ", "))
expected_vent[[1]]
attributes(dat_vent)
class(dat_vent)
dat_vent <- new_vent(dat_vent)
attributes(dat_vent)
names(attributes(dat_vent))
View(expected_vent)
expected_vent[[1]]
row.names(expected_vent)
devtools::load_all(".")
validate_vent(dat_vent)
devtools::load_all(".")
validate_vent(dat_vent)
devtools::load_all(".")
validate_vent(dat_vent)
devtools::load_all(".")
validate_vent(dat_vent)
!c("bin", "baseline") %in% names(attributes(dat_vent))
any(!c("bin", "baseline") %in% names(attributes(dat_vent)))
devtools::load_all(".")
devtools::load_all(".")
validate_vent(dat_vent)
load("~/Documents/R_projects/rvent/R/sysdata.rda")
iox_head <- vent_head
usethis::use_data(dat_vent, comments_tofill, iox_head, sess1, internal = TRUE, overwrite = TRUE)
load("~/Documents/R_projects/rvent/R/sysdata.rda")
names(dat_vent)
names(sess1$rat1_heroin)
devtools::load_all(".")
find_bins(sess1$rat1_heroin, 30, 3)
devtools::load_all(".")
devtools::load_all(".")
prova <- median_bins(sess1$rat1_heroin)
View(dat)
glimpse(dat)
tidyr::glimpse(dat)
dplyr::glimpse(dat)
dat_vent <- dat_long %>%
dplyr::group_by(.data$cpu_date, .data$subj_drug, .data$dose, .data$unit, .data$int_min, .data$measure) %>%
dplyr::summarise(mean = mean(.data$value),
median = median(.data$value),
sd = sd(.data$value),
n = dplyr::n(),
baseline = baseline,
bin = bin) %>%
tidyr::separate(.data$subj_drug, c("subj", "drug"), remove = TRUE)
col_melt <- which(names(dat_all) %in% c("Ti_msec", "Sr_per"))
library(rvent)
sess1 <- import_session()
session_plots(sess1, inter = FALSE, bin = 1)
session_plots(sess1, inter = FALSE, bin = 1)
devtools::load_all(".")
session_plots(sess1, inter = FALSE, bin = 1)
devtools::load_all(".")
sess1 <- import_session()
library(rvent)
sess1 <- import_session()
session_plots(sess1, inter = FALSE, bin = 1)
session_plots(sess1, bin = 1)
library(rvent)
library(rvent)
sess1 <- import_session()
session_plots(sess1, inter = FALSE, bin = 10)
summarize_vent(sess1)
usethis::use_package(readxl)
install.packages("readxl")
usethis::use_package(readxl)
usethis::use_package("readxl")
devtools::load_all(".")
load("~/Documents/R_projects/rvent/R/sysdata.rda")
summarize_vent(sess1)
View(dat_sm)
dat_vent$cpu_date[1]
as_string(dat_vent$cpu_date[1]))
as_string(dat_vent$cpu_date[1])
as_string(dat_vent$cpu_date[1])
as.character(dat_vent$cpu_date[1])
paste0("summary_", as.character(dat_vent$cpu_date[1], ".xlsx")
writexl::write_xlsx(dat_fs, "summary.xlsx")
} else {
return(list(dat_long = dat_long, dat_vent = dat_vent, dat_sm = dat_sm, dat_fs = dat_fs))
}
}
paste0("summary_", as.character(dat_vent$cpu_date[1]), ".xlsx")
devtools::load_all(".")
summarize_vent(sess1)
sess1 <- import_session(sess1)
sess1 <- import_session(sess1)
sess1 <- import_session(sess1)
devtools::load_all("~/Documents/R_projects/rvent")
sess1 <- import_session(sess1)
devtools::load_all("~/Documents/R_projects/rvent")
sess1 <- import_session(sess1)
baseline <- as.numeric(baseline) * 60 # 30 min baseline
baseline
sess1 <- import_session(sess1)
baseline
sess1 <- import_session(sess1)
sess1 <- import_session()
devtools::load_all("~/Documents/R_projects/rvent")
sess1 <- import_session()
summarize_vent(sess1)
bind_summary()
purrr:map_dfr(files_imp, readx:read_xlsx)
purrr::map_dfr(files_imp, readx:read_xlsx)
purrr::map_dfr(files_imp, readxl::read_xlsx)
readxl::read_xlsx(files_imp[1])
prova <- readxl::read_xlsx(files_imp[1])
View(prova)
prova <- readxl::read_excel(files_imp[1])
View(prova)
install.packages("rio")
prova <- rio::import_list(files_imp[1])
View(prova)
prova2 <- rio::import_list(files_imp[2])
rbind(prova, prova2)
x <- rbind(prova, prova2)
View(x)
prova <- do(rio::import_list(files_imp[1]), rbind)
prova <- do.call(rbind, rio::import_list(files_imp[1]))
View(prova)
mylist <- lapply(excel_sheets(files_imp[1]), read_excel, path = files_imp[1])
mylist <- lapply(readxl::excel_sheets(files_imp[1]), readxl::read_excel, path = files_imp[1])
View(mylist)
rio::import_list(files_imp[1], rbind = TRUE)
rio::import_list(files_imp[1], rbind = TRUE, rbind_label = FALSE)
rio::import_list(files_imp[1], rbind = TRUE)
rio::import_list(files_imp, rbind = TRUE)
prova <- rio::import_list(files_imp, rbind = TRUE)
View(prova)
prova <- rio::import_list(files_imp, rbind = TRUE)
prova <- rio::import_list(files_imp[1], rbind = TRUE)
files_imp[1]
rio::import_list(files_imp[1], rbind = TRUE)
prova <-   rio::import_list(files_imp[1], rbind = TRUE)
View(prova)
prova2 <-   rio::import_list(files_imp, rbind = TRUE)
prova2 <-   rio::import_list(files_imp, rbind = TRUE)
prova3 <-   rio::import_list(files_imp[1], rbind = TRUE)
prova3 <-   rio::import_list(files_imp, rbind = TRUE)
prova3 <- purrr::map_dfr(files_imp, rio::import_list, rbind = TRUE)
dat_all <- purrr::map_dfr(files_imp, rio::import_list, rbind = TRUE)
dat_all
suppressWarnings(dat_fs <- split.data.frame(dat_all, dat_all$measure))
unique(dat_all$cpu_date)
as.character(unique(dat_all$cpu_date))
paste(as.character(unique(dat_all$cpu_date)), collapse = "_")
dates <- paste(as.character(unique(dat_all$cpu_date)), collapse = "_")
paste0("summary_", dates, ".xlsx")
writexl::write_xlsx(dat_fs, paste0("summary_", dates, ".xlsx"))
devtools::load_all("~/Documents/R_projects/rvent")
bind_summary()
devtools::load_all("~/Documents/R_projects/rvent")
bind_summary()
if(inter == TRUE) {
svDialogs::dlg_message("Next select the folder where to save the summary", type = "ok")$res
file_p <- svDialogs::dlg_dir()$res
setwd(file_p)
writexl::write_xlsx(dat_fs, paste0("summary_", as.character(dat_vent$cpu_date[1]), ".xlsx"))
} else {
return(dat_fs)
}
devtools::load_all("~/Documents/R_projects/rvent")
bind_summary()
devtools::load_all("~/Documents/R_projects/rvent")
bind_summary()
devtools::load_all("~/Documents/R_projects/rvent")
bind_summary()
bind_summary()
devtools::load_all("~/Documents/R_projects/rvent")
devtools::load_all("~/Documents/R_projects/rvent")
bind_summary()
bind_summary()
bind_summary()
bind_summary()
names(dat_all)
dplyr::select(dat_all, -dat_all$_file)
dplyr::select(dat_all, -.data$_file)
dat_all <- purrr::map_dfr(files_imp, rio::import_list, rbind = TRUE, rbind_label = "label")
names(dat_all)
dat_all <- purrr::map_dfr(files_imp, rio::import_list, rbind = TRUE, rbind_label = "label")
names(dat_all)
dplyr::select(dat_all, -.data$label)
dat_all[, names(dat_all) != "label"]
prova  <- dat_all[, names(dat_all) != "label"]
View(prova)
devtools::load_all("~/Documents/R_projects/rvent")
usethis::use_package("rio")
bsummary <- bind_summary("/Users/heverz/Documents/R_projects/rvent/inst/extdata/summary", inter = FALSE)
bsummary <- bind_summary("/Users/heverz/Documents/R_projects/rvent/inst/extdata/summary", inter = FALSE)
devtools::load_all("~/Documents/R_projects/rvent")
bsummary <- bind_summary("/Users/heverz/Documents/R_projects/rvent/inst/extdata/summary", inter = FALSE)
devtools::load_all("~/Documents/R_projects/rvent")
bsummary <- bind_summary("/Users/heverz/Documents/R_projects/rvent/inst/extdata/summary", inter = FALSE)
devtools::load_all("~/Documents/R_projects/rvent")
devtools::load_all("~/Documents/R_projects/rvent")
bsummary <- bind_summary("/Users/heverz/Documents/R_projects/rvent/inst/extdata/summary", inter = FALSE)
bsummary_exp <- "/Users/heverz/Documents/R_projects/rvent/tests/testthat/bsummary_exp"
test_that("bind_summary output",{
expect_known_output(bsummary, bsummary_exp, print = TRUE)
})
devtools::load_all(".")
load("~/Documents/R_projects/rvent/R/sysdata.rda")
summarize_vent(sess1)
tidyr::pivot_longer(dat_all, cols = col_melt[1]:col_melt[2], names_to = "measure",
values_to = "value")
col_melt[1]:col_melt[2]
# wide to long
prova <- col_melt[1]:col_melt[2]
# wide to long
prova <- col_melt[1]:col_melt[2]
dat_long <- tidyr::pivot_longer(dat_all, cols = !!prova, names_to = "measure",
values_to = "value")
dat_long <- data.table::melt(as.data.table(dat_all), measure.vars = col_melt[1]:col_melt[2],
variable.name = "measure", value.name = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols = !!!prova, names_to = "measure",
values_to = "value")
dat_all
col_melt[1]:col_melt[2]
dat_long <- tidyr::pivot_longer(dat_all, cols = !!col_melt[1]:!!col_melt[2], names_to = "measure",
values_to = "value")
col_melt[1]:col_melt[2]
dat_long <- tidyr::pivot_longer(dat_all, cols = 15:34, names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols = c(15:34), names_to = "measure",
values_to = "value")
# wide to long
prova <- names(dat_all)[col_melt[1]:col_melt[2]]
prova
dat_long <- tidyr::pivot_longer(dat_all, cols = !!prova, names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols = prova, names_to = "measure",
values_to = "value")
prova
dat_long <- tidyr::pivot_longer(dat_all, cols =  prova, names_to = "measure",
values_to = "value")
col_melt
dat_long <- tidyr::pivot_longer(dat_all, cols =  col_melt, names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols =  !!col_melt, names_to = "measure",
values_to = "value")
paste(".data$", prova)
paste(".data$", prova, sep ="")
prava2<- paste(".data$", prova, sep ="")
dat_long <- tidyr::pivot_longer(dat_all, cols =  !!prov2a, names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols =  !!prova2, names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols =  !!!prova2, names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols =  eval(parse_expr(prova2)), names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols =  eval(rlang::parse_expr(prova2)), names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols =  eval(prova2), names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols =  eval(prova2), names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols =  parse(prova2), names_to = "measure",
values_to = "value")
prava2<- paste(".data$", prova, sep ="")
dat_long <- tidyr::pivot_longer(dat_all, cols =  parse(prova2), names_to = "measure",
values_to = "value")
dat_long <- tidyr::pivot_longer(dat_all, cols =  !!prova2, names_to = "measure",
values_to = "value")
prava2<- paste(".data$", prova, sep ="")
prava2
prava2
library(rvent)
import_session()
